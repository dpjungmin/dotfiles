{{ if eq .chezmoi.os "darwin" -}}
#!/bin/bash -x

PACKAGES=(
    fish
    starship
    tmux
    tmuxp
    neovim
    exa
    bat
    ripgrep
    fd
    zoxide
    fzf
    btop
    node
    hyperfine
    lazygit
    telnet
    chezmoi
    cmake
    cmake-docs
    clang-format
    python3
    black
    rust-analyzer
    binutils
    git-delta
    just
    fping
    gh
    lua
)

CASKS=(
    amethyst
    alacritty
    font-lekton-nerd-font
    font-noto-nerd-font
)

FISH_PLUGINS=(
    jorgebucaran/fisher
    jethrokuan/z
)

# Install Homebrew if it is not installed on the system
if [[ -z "$(which brew)" ]]; then
    printf '\n\n\e[33mHomebrew not found. \e[0mInstalling Homebrew...'
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
fi

printf '\Initiating Homebrew...\n'
brew update
brew install ${PACKAGES[@]}
brew cleanup
brew tap homebrew/cask-fonts
brew install cask
brew install --cask ${CASKS[@]}

SHELL="$(which fish)"

if [[ "$SHELL" == "*/fish" ]]; then
    $SHELL << EOF

    printf '\nInstalling Fisher...\n'
    curl -sL https://raw.githubusercontent.com/jorgebucaran/fisher/main/functions/fisher.fish | source

    printf '\nInstalling fish-shell plugins...\n'
    fisher install ${FISH_PLUGINS[@]}

EOF
fi

printf '\nInstalling other dependencies...\n'

pip3 install -U pynvim # Install Neovim dependency

if [[ ! -d "~/.tmux/plugins/tpm" ]]; then
    printf '\nInstalling Tmux Plugin Manager...\n'
    git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
fi

# Install rustup if it is not installed on the system
if [[ -z "$(which rustup)" ]]; then
    printf '\n\n\e[33mrustup not found. \e[0mInstalling rustup...'
    curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
fi

if [[ -z "$(which stylua)" ]]; then
    cargo install stylua
fi

if [[ -z "$(which git-stack)" ]]; then
    cargo install git-stack
fi

if [[ -z "$(which npm)" ]]; then
    npm install -g npm
fi

printf '\n\nDone!!\n'

{{ end -}}
